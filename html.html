<style>
  * {
    box-sizing: border-box;
  }

  :root {
    /* Use Figma's theme colors when available, fallback to light mode */
    --bg-primary: var(--figma-color-bg, #ffffff);
    --bg-secondary: var(--figma-color-bg-secondary, #fafafa);
    --bg-hover: var(--figma-color-bg-hover, #f0f0f0);
    --bg-active: var(--figma-color-bg-pressed, #e5e5e5);
    --text-primary: var(--figma-color-text, #1a1a1a);
    --text-secondary: var(--figma-color-text-secondary, #666);
    --text-tertiary: var(--figma-color-text-tertiary, #999);
    --border-primary: var(--figma-color-border, #e0e0e0);
    --border-secondary: var(--figma-color-border, rgba(0, 0, 0, 0.1));
    --track-bg: var(--figma-color-bg-secondary, #e8e8e8);
    --track-hover: var(--figma-color-bg-hover, #d8d8d8);
    --tooltip-bg: var(--figma-color-bg-inverse, #2d2d2d);
    --tooltip-text: var(--figma-color-text-oninverse, #fff);
    --accent-primary: var(--figma-color-bg-brand, #18a0fb);
    --accent-hover: var(--figma-color-bg-brand-hover, #0d8ce8);
    --button-secondary-bg: var(--figma-color-bg-secondary, #f5f5f5);
    --button-secondary-text: var(--figma-color-text-secondary, #666);
    --button-secondary-hover-bg: var(--figma-color-bg-hover, #e8e8e8);
    --button-secondary-hover-text: var(--figma-color-text, #333);
  }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    padding: 20px;
    margin: 0;
    background: var(--bg-primary);
    color: var(--text-primary);
  }

  h2 {
    margin: 0 0 24px 0;
    font-size: 13px;
    font-weight: 600;
    letter-spacing: -0.01em;
    color: var(--text-primary);
  }

  .slider-group {
    margin-bottom: 18px;
    position: relative;
  }

  label {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 11px;
    font-weight: 500;
    margin-bottom: 10px;
    color: var(--text-secondary);
    letter-spacing: 0.01em;
    text-transform: uppercase;
    position: relative;
    cursor: help;
  }

  label .label-text {
    position: relative;
  }

  label .label-tooltip {
    visibility: hidden;
    position: absolute;
    left: 0;
    bottom: calc(100% + 8px);
    width: 220px;
    background: var(--tooltip-bg);
    color: var(--tooltip-text);
    text-align: left;
    border-radius: 6px;
    padding: 10px 12px;
    z-index: 10000;
    opacity: 0;
    transition: opacity 0.2s ease, visibility 0.2s ease;
    transition-delay: 0s;
    font-weight: 400;
    font-size: 10px;
    line-height: 1.5;
    pointer-events: none;
    white-space: normal;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    text-transform: none;
  }

  label .label-tooltip::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 12px;
    border-width: 6px;
    border-style: solid;
    border-color: var(--tooltip-bg) transparent transparent transparent;
  }

  label:hover .label-tooltip {
    visibility: visible;
    opacity: 1;
    transition-delay: 0.8s;
  }

  .slider-container {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .slider-wrapper {
    flex: 1;
    position: relative;
    height: 32px;
    display: flex;
    align-items: center;
  }

  .slider-track {
    position: absolute;
    width: 100%;
    height: 3px;
    background: var(--track-bg);
    border-radius: 2px;
    pointer-events: none;
    transition: background 0.2s ease;
  }

  .slider-progress {
    position: absolute;
    height: 3px;
    background: linear-gradient(90deg, var(--accent-primary), var(--accent-hover));
    border-radius: 2px;
    pointer-events: none;
    transition: opacity 0.2s ease;
    opacity: 0;
  }

  input[type="range"] {
    position: relative;
    width: 100%;
    height: 32px;
    -webkit-appearance: none;
    appearance: none;
    background: transparent;
    outline: none;
    cursor: pointer;
    z-index: 2;
  }

  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 14px;
    height: 14px;
    background: var(--accent-primary);
    border-radius: 50%;
    cursor: grab;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 0 0 0 rgba(24, 160, 251, 0.3);
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  }

  input[type="range"]::-webkit-slider-thumb:hover {
    transform: scale(1.15);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), 0 0 0 4px rgba(24, 160, 251, 0.1);
  }

  input[type="range"]:active::-webkit-slider-thumb {
    cursor: grabbing;
    transform: scale(1.05);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2), 0 0 0 6px rgba(24, 160, 251, 0.15);
  }

  input[type="range"]::-moz-range-thumb {
    width: 14px;
    height: 14px;
    background: var(--accent-primary);
    border-radius: 50%;
    cursor: grab;
    border: none;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 0 0 0 rgba(24, 160, 251, 0.3);
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  }

  input[type="range"]::-moz-range-thumb:hover {
    transform: scale(1.15);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), 0 0 0 4px rgba(24, 160, 251, 0.1);
  }

  input[type="range"]:active::-moz-range-thumb {
    cursor: grabbing;
    transform: scale(1.05);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2), 0 0 0 6px rgba(24, 160, 251, 0.15);
  }

  .slider-wrapper:hover .slider-track {
    background: var(--track-hover);
  }

  .slider-wrapper:hover .slider-progress {
    opacity: 1;
  }

  input[type="range"]:focus-visible {
    outline: none;
  }

  input[type="range"]:focus-visible::-webkit-slider-thumb {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), 0 0 0 4px rgba(24, 160, 251, 0.2);
  }

  input[type="range"]:focus-visible::-moz-range-thumb {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), 0 0 0 4px rgba(24, 160, 251, 0.2);
  }

  .value-display {
    min-width: 48px;
    text-align: center;
    font-size: 11px;
    font-weight: 500;
    color: var(--text-primary);
    padding: 6px 8px;
    border: 1px solid var(--border-primary);
    border-radius: 4px;
    background: var(--bg-secondary);
    transition: all 0.2s ease;
  }

  .value-display:hover {
    border-color: var(--border-primary);
    background: var(--bg-primary);
  }

  .value-display:focus {
    outline: none;
    border-color: var(--accent-primary);
    background: var(--bg-primary);
    box-shadow: 0 0 0 3px rgba(24, 160, 251, 0.1);
  }

  .reset-button {
    width: 24px;
    height: 24px;
    min-width: 24px;
    max-width: 24px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: 1px solid var(--border-primary);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
    flex-shrink: 0;
    flex-grow: 0;
  }

  .reset-button:not(:disabled):hover {
    background: var(--bg-hover);
    border-color: var(--accent-primary);
  }

  .reset-button:not(:disabled):active {
    background: var(--bg-active);
    transform: scale(0.95);
  }

  .reset-button:disabled {
    opacity: 0.3;
    cursor: not-allowed;
    border-color: var(--border-secondary);
  }

  .reset-button svg {
    width: 12px;
    height: 12px;
    fill: var(--text-secondary);
    transition: fill 0.2s ease;
  }

  .reset-button:not(:disabled):hover svg {
    fill: var(--accent-primary);
  }

  .reset-button:disabled svg {
    fill: var(--text-tertiary);
  }

  .preview-container {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 20px;
    padding: 8px 0;
  }

  .preview-checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    user-select: none;
  }

  .preview-checkbox input[type="checkbox"] {
    width: 14px;
    height: 14px;
    cursor: pointer;
    accent-color: var(--accent-primary);
  }

  .preview-checkbox label {
    font-size: 11px;
    font-weight: 500;
    color: var(--text-primary);
    cursor: pointer;
    margin: 0;
    text-transform: none;
    letter-spacing: 0;
  }

  .button-group {
    display: flex;
    gap: 8px;
    margin-top: 12px;
    padding-top: 4px;
  }

  button {
    flex: 1;
    padding: 10px 16px;
    font-size: 11px;
    font-weight: 600;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    letter-spacing: 0.01em;
  }

  #apply {
    background: var(--accent-primary);
    color: white;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
  }

  #apply:hover {
    background: var(--accent-hover);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(24, 160, 251, 0.3);
  }

  #apply:active {
    transform: translateY(0);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
  }

  #cancel {
    background: var(--button-secondary-bg);
    color: var(--button-secondary-text);
  }

  #cancel:hover {
    background: var(--button-secondary-hover-bg);
    color: var(--button-secondary-hover-text);
    transform: translateY(-1px);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
  }

  #cancel:active {
    transform: translateY(0);
    box-shadow: none;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(4px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .slider-group {
    animation: fadeIn 0.3s ease forwards;
  }

  .slider-group:nth-child(2) {
    animation-delay: 0.05s;
  }

  .slider-group:nth-child(3) {
    animation-delay: 0.1s;
  }

  .slider-group:nth-child(4) {
    animation-delay: 0.15s;
  }

  .footer {
    margin-top: 24px;
    padding-top: 16px;
    border-top: 1px solid var(--border-secondary);
    font-size: 10px;
    color: var(--text-tertiary);
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .footer a {
    color: var(--accent-primary);
    text-decoration: none;
    transition: all 0.2s ease;
    position: relative;
  }

  .footer a:hover {
    color: var(--accent-hover);
    text-decoration: underline;
  }



  .footer a .link-tooltip {
    visibility: hidden;
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    bottom: calc(100% + 10px);
    width: max-content;
    background: var(--tooltip-bg);
    color: var(--tooltip-text);
    text-align: center;
    border-radius: 6px;
    padding: 8px 10px;
    z-index: 99999;
    opacity: 0;
    transition: opacity 0.2s ease, visibility 0.2s ease;
    transition-delay: 0s;
    font-weight: 400;
    font-size: 10px;
    line-height: 1.4;
    pointer-events: none;
    white-space: nowrap;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  }

  .footer a .link-tooltip::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    border-width: 5px;
    border-style: solid;
    border-color: var(--tooltip-bg) transparent transparent transparent;
  }

  .footer a:hover .link-tooltip {
    visibility: visible;
    opacity: 1;
    transition-delay: 0.8s;
  }

  .support-button {
    position: absolute;
    right: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    background: transparent;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    padding: 0;
    transition: all 0.2s ease;
    flex-shrink: 0;
    overflow: visible;
    transform: scale(0.833);
    transform-origin: center;
  }

  .support-button:hover {
    transform: scale(1);
  }

  .support-button svg {
    width: 18px;
    height: 18px;
    fill: var(--text-tertiary);
    transition: all 0.2s ease;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  .support-button .icon-default {
    opacity: 1;
    transition: opacity 0.2s ease;
  }

  .support-button .icon-hover {
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .support-button:hover {
    background: var(--bg-hover);
  }

  .support-button:hover .icon-default {
    opacity: 0;
  }

  .support-button:hover .icon-hover {
    opacity: 1;
  }

  .support-button:hover svg {
    fill: var(--accent-primary);
  }

  .support-button:active {
    background: var(--bg-active);
  }

  .support-button .support-tooltip {
    visibility: hidden;
    position: absolute;
    right: 0;
    bottom: calc(100% + 10px);
    width: max-content;
    background: var(--tooltip-bg);
    color: var(--tooltip-text);
    text-align: center;
    border-radius: 6px;
    padding: 8px 10px;
    z-index: 99999;
    opacity: 0;
    transition: opacity 0.2s ease, visibility 0.2s ease;
    transition-delay: 0s;
    font-weight: 400;
    font-size: 10px;
    line-height: 1.4;
    pointer-events: none;
    white-space: nowrap;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  }

  .support-button .support-tooltip::after {
    content: "";
    position: absolute;
    top: 100%;
    right: 10px;
    border-width: 5px;
    border-style: solid;
    border-color: var(--tooltip-bg) transparent transparent transparent;
  }

  .support-button:hover .support-tooltip {
    visibility: visible;
    opacity: 1;
    transition-delay: 0.8s;
  }
</style>

<h2>HSL Color Adjustment</h2>

<div class="slider-group">
  <label for="hue">
    <span class="label-text">Hue
      <span class="label-tooltip">
        Shifts the color around the color wheel. Positive values shift clockwise, negative values shift
        counterclockwise.
      </span>
    </span>
  </label>
  <div class="slider-container">
    <div class="slider-wrapper">
      <div class="slider-track"></div>
      <div class="slider-progress" id="hue-progress"></div>
      <input type="range" id="hue" min="-180" max="180" value="0" step="1">
    </div>
    <input type="number" class="value-display" id="hue-value" value="0" min="-180" max="180" step="1">
    <button class="reset-button" id="hue-reset" disabled>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path
          d="M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59 7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12 5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z" />
      </svg>
    </button>
  </div>
</div>

<div class="slider-group">
  <label for="saturation">
    <span class="label-text">Saturation
      <span class="label-tooltip">
        Adjusts color intensity. Positive values make colors more vibrant, negative values make them more gray.
      </span>
    </span>
  </label>
  <div class="slider-container">
    <div class="slider-wrapper">
      <div class="slider-track"></div>
      <div class="slider-progress" id="saturation-progress"></div>
      <input type="range" id="saturation" min="-100" max="100" value="0" step="1">
    </div>
    <input type="number" class="value-display" id="saturation-value" value="0" min="-100" max="100" step="1">
    <button class="reset-button" id="saturation-reset" disabled>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path
          d="M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59 7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12 5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z" />
      </svg>
    </button>
  </div>
</div>

<div class="slider-group">
  <label for="lightness">
    <span class="label-text">Lightness
      <span class="label-tooltip">
        Adjusts brightness. Positive values make colors lighter, negative values make them darker.
      </span>
    </span>
  </label>
  <div class="slider-container">
    <div class="slider-wrapper">
      <div class="slider-track"></div>
      <div class="slider-progress" id="lightness-progress"></div>
      <input type="range" id="lightness" min="-100" max="100" value="0" step="1">
    </div>
    <input type="number" class="value-display" id="lightness-value" value="0" min="-100" max="100" step="1">
    <button class="reset-button" id="lightness-reset" disabled>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path
          d="M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59 7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12 5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z" />
      </svg>
    </button>
  </div>
</div>

<div class="preview-container">
  <div class="preview-checkbox">
    <input type="checkbox" id="preview-toggle" checked>
    <label for="preview-toggle">Preview</label>
  </div>
</div>

<div class="button-group">
  <button id="cancel">Cancel</button>
  <button id="apply">Apply</button>
</div>

<div class="footer">
  <span>Â© 2025 <a href="https://samolevsky.com/" target="_blank">Samolevsky.com<span class="link-tooltip">Discover more
        design tools</span></a></span>
  <button class="support-button" id="supportButton">
    <svg class="icon-default" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <path d="M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Zm0,26A12,12,0,1,1,28,16,12,12,0,0,1,16,28Z" />
      <path d="M11.5,11A2.5,2.5,0,1,0,14,13.5,2.48,2.48,0,0,0,11.5,11Z" />
      <path d="M20.5,11A2.5,2.5,0,1,0,23,13.5,2.48,2.48,0,0,0,20.5,11Z" />
      <path d="M16,24a8,8,0,0,0,6.85-3.89l-1.71-1a6,6,0,0,1-10.28,0l-1.71,1A8,8,0,0,0,16,24Z" />
    </svg>
    <svg class="icon-hover" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <path d="M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Zm0,26A12,12,0,1,1,28,16,12,12,0,0,1,16,28Z" />
      <path d="M20.5,11A2.5,2.5,0,1,0,23,13.5,2.5,2.5,0,0,0,20.5,11Z" />
      <rect x="8" y="13" width="6" height="2" />
      <path d="M16,24a8,8,0,0,0,6.85-3.89l-1.71-1a6,6,0,0,1-10.28,0l-1.71,1A8,8,0,0,0,16,24Z" />
    </svg>
    <span class="support-tooltip">Support plugin development</span>
  </button>
</div>

<script>
  const hueSlider = document.getElementById('hue');
  const saturationSlider = document.getElementById('saturation');
  const lightnessSlider = document.getElementById('lightness');

  const hueValue = document.getElementById('hue-value');
  const saturationValue = document.getElementById('saturation-value');
  const lightnessValue = document.getElementById('lightness-value');

  const hueProgress = document.getElementById('hue-progress');
  const saturationProgress = document.getElementById('saturation-progress');
  const lightnessProgress = document.getElementById('lightness-progress');

  const hueReset = document.getElementById('hue-reset');
  const saturationReset = document.getElementById('saturation-reset');
  const lightnessReset = document.getElementById('lightness-reset');

  const previewToggle = document.getElementById('preview-toggle');

  function updateProgress(slider, progress, min, max) {
    const value = parseFloat(slider.value);
    const range = max - min;
    const centerPercent = Math.abs(min) / range * 100;
    const valuePercent = (value - min) / range * 100;

    if (value >= 0) {
      progress.style.left = centerPercent + '%';
      progress.style.width = (valuePercent - centerPercent) + '%';
    } else {
      progress.style.left = valuePercent + '%';
      progress.style.width = (centerPercent - valuePercent) + '%';
    }

    progress.style.opacity = value !== 0 ? '1' : '0';
  }

  function updateResetButton(resetButton, value) {
    resetButton.disabled = value === 0;
  }

  function sendPreview() {
    if (!previewToggle.checked) {
      // If preview is off, reset to original colors
      parent.postMessage({
        pluginMessage: {
          type: 'preview',
          hue: 0,
          saturation: 0,
          lightness: 0
        }
      }, '*');
      return;
    }

    const hue = parseInt(hueSlider.value, 10);
    const saturation = parseInt(saturationSlider.value, 10);
    const lightness = parseInt(lightnessSlider.value, 10);

    parent.postMessage({
      pluginMessage: {
        type: 'preview',
        hue,
        saturation,
        lightness
      }
    }, '*');
  }

  // Handle preview toggle
  previewToggle.onchange = () => {
    sendPreview();
  };

  hueSlider.oninput = () => {
    hueValue.value = hueSlider.value;
    updateProgress(hueSlider, hueProgress, -180, 180);
    updateResetButton(hueReset, parseInt(hueSlider.value, 10));
    sendPreview();
  };

  saturationSlider.oninput = () => {
    saturationValue.value = saturationSlider.value;
    updateProgress(saturationSlider, saturationProgress, -100, 100);
    updateResetButton(saturationReset, parseInt(saturationSlider.value, 10));
    sendPreview();
  };

  lightnessSlider.oninput = () => {
    lightnessValue.value = lightnessSlider.value;
    updateProgress(lightnessSlider, lightnessProgress, -100, 100);
    updateResetButton(lightnessReset, parseInt(lightnessSlider.value, 10));
    sendPreview();
  };

  hueValue.oninput = () => {
    let val = parseInt(hueValue.value, 10);
    if (isNaN(val)) val = 0;
    val = Math.max(-180, Math.min(180, val));
    hueSlider.value = val.toString();
    hueValue.value = val.toString();
    updateProgress(hueSlider, hueProgress, -180, 180);
    updateResetButton(hueReset, val);
    sendPreview();
  };

  saturationValue.oninput = () => {
    let val = parseInt(saturationValue.value, 10);
    if (isNaN(val)) val = 0;
    val = Math.max(-100, Math.min(100, val));
    saturationSlider.value = val.toString();
    saturationValue.value = val.toString();
    updateProgress(saturationSlider, saturationProgress, -100, 100);
    updateResetButton(saturationReset, val);
    sendPreview();
  };

  lightnessValue.oninput = () => {
    let val = parseInt(lightnessValue.value, 10);
    if (isNaN(val)) val = 0;
    val = Math.max(-100, Math.min(100, val));
    lightnessSlider.value = val.toString();
    lightnessValue.value = val.toString();
    updateProgress(lightnessSlider, lightnessProgress, -100, 100);
    updateResetButton(lightnessReset, val);
    sendPreview();
  };

  document.getElementById('apply').onclick = () => {
    const hue = parseInt(hueSlider.value, 10);
    const saturation = parseInt(saturationSlider.value, 10);
    const lightness = parseInt(lightnessSlider.value, 10);

    parent.postMessage({
      pluginMessage: {
        type: 'apply',
        hue,
        saturation,
        lightness
      }
    }, '*');
  };

  document.getElementById('cancel').onclick = () => {
    parent.postMessage({ pluginMessage: { type: 'cancel' } }, '*');
  };

  document.getElementById('supportButton').onclick = () => {
    parent.postMessage({ pluginMessage: { type: 'open-support' } }, '*');
  };

  // Reset button handlers
  hueReset.onclick = () => {
    hueSlider.value = '0';
    hueValue.value = '0';
    updateProgress(hueSlider, hueProgress, -180, 180);
    updateResetButton(hueReset, 0);
    sendPreview();
  };

  saturationReset.onclick = () => {
    saturationSlider.value = '0';
    saturationValue.value = '0';
    updateProgress(saturationSlider, saturationProgress, -100, 100);
    updateResetButton(saturationReset, 0);
    sendPreview();
  };

  lightnessReset.onclick = () => {
    lightnessSlider.value = '0';
    lightnessValue.value = '0';
    updateProgress(lightnessSlider, lightnessProgress, -100, 100);
    updateResetButton(lightnessReset, 0);
    sendPreview();
  };

  // Right-click to reset sliders to 0
  hueSlider.oncontextmenu = (e) => {
    e.preventDefault();
    hueSlider.value = '0';
    hueValue.value = '0';
    updateProgress(hueSlider, hueProgress, -180, 180);
    updateResetButton(hueReset, 0);
    sendPreview();
  };

  saturationSlider.oncontextmenu = (e) => {
    e.preventDefault();
    saturationSlider.value = '0';
    saturationValue.value = '0';
    updateProgress(saturationSlider, saturationProgress, -100, 100);
    updateResetButton(saturationReset, 0);
    sendPreview();
  };

  lightnessSlider.oncontextmenu = (e) => {
    e.preventDefault();
    lightnessSlider.value = '0';
    lightnessValue.value = '0';
    updateProgress(lightnessSlider, lightnessProgress, -100, 100);
    updateResetButton(lightnessReset, 0);
    sendPreview();
  };

  // Initialize progress bars
  updateProgress(hueSlider, hueProgress, -180, 180);
  updateProgress(saturationSlider, saturationProgress, -100, 100);
  updateProgress(lightnessSlider, lightnessProgress, -100, 100);

  // Initialize
  parent.postMessage({ pluginMessage: { type: 'init' } }, '*');
</script>